SubDir TOP eressea ;

TargetDirectory ;
SubDirHdrs $(SUBDIR)/../src/build ;
SubDirHdrs $(SUBDIR)/../src/kernel ;
SubDirHdrs $(SUBDIR)/../src/util ;
SubDirHdrs $(SUBDIR)/../src ;
SubDirHdrs $(SUBDIR)/../external ;
SubDirHdrs $(SUBDIR)/.. ;

UsingLua ;

SEARCH_SOURCE += [ FDirName $(TOP) src build ] ;
SEARCH_SOURCE += [ FDirName $(SUBDIR) src ] ;
SubDirC++Flags -DHAVE_LUA ;

SubDirHdrs $(XMLHDRS) ;

SERVER = eressea ;

SERVER_SOURCES = 
 <build!external.c>
 <build!gamecode.c>
 <build!kernel.c>
 <build!lib.c>
 <build!util.c>
 <src!server.c>
 ;

libtolua $(SERVER) ;
liblua $(SERVER) ;

# eressea-server with lua scripting
libxml2 $(SERVER) ;
libcurses $(SERVER) ;

LINKLIBS on $(SERVER) += -lm -ldl -lstdc++ ;
Main $(SERVER) : $(SERVER_SOURCES) ;
