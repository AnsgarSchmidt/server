SubDir TOP eressea ;

TargetDirectory ;
SubDirHdrs $(SUBDIR)/../common/gamecode ;
SubDirHdrs $(SUBDIR)/../common/kernel ;
SubDirHdrs $(SUBDIR)/../common/util ;
SubDirHdrs $(SUBDIR)/../common ;
SubDirHdrs $(SUBDIR)/.. ;

if $(HAVE_LUA) {
 SubDirC++Flags -DHAVE_LUA ;
 UsingLua ;
 UsingLuabind ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) lua ] ;
}

if $(HAVE_LUA) {
 BINARY = eressea-lua ;
 SOURCES =
  <lua>alliance.cpp
  <lua>building.cpp
  <lua>eressea.cpp
  <lua>faction.cpp
  <lua>region.cpp
  <lua>ship.cpp
  <lua>unit.cpp
  main.cpp
  ;

 LINKLIBS on $(BINARY) += -llua50 -llualib50 ;
 LINKLIBS on $(BINARY) += -lluabind ;
 LINKLIBS on $(BINARY) += -ldl -lstdc++ ;
} else {
 BINARY = eressea ;
 SOURCES = main.c ;
}

SOURCES += korrektur.c ;

Main $(BINARY) : $(SOURCES) ;
LinkLibraries $(BINARY) :
 kernel 
 gamecode 
 items 
 modules
 attributes
 spells
 races
 triggers 
 util
 ;
 
LINKLIBS on $(BINARY) += -lm ;
