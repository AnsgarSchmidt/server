SubDir TOP eressea ;

TargetDirectory ;
SubDirHdrs $(SUBDIR)/../common/gamecode ;
SubDirHdrs $(SUBDIR)/../common/kernel ;
SubDirHdrs $(SUBDIR)/../common/util ;
SubDirHdrs $(SUBDIR)/../common ;
SubDirHdrs $(SUBDIR)/.. ;

LUASERVER = eressea-lua ;
SERVER = eressea ;

SERVER_SOURCES = main.c korrektur.c ;
LUASERVER_SOURCES =
 <lua>alliance.cpp
 <lua>building.cpp
 <lua>eressea.cpp
 <lua>faction.cpp
 <lua>region.cpp
 <lua>ship.cpp
 <lua>unit.cpp
 server.cpp
 korrektur.c
 ;

LinkLibraries $(SERVER) :
 kernel gamecode items modules attributes spells races triggers util ;
LinkLibraries $(LUASERVER) :
 kernel gamecode items modules attributes spells races triggers util ;
 
LINKLIBS on $(SERVER) += -lm ;
LINKLIBS on $(LUASERVER) += -L$(LUABIND_ROOT)/lib -llua50 -llualib50 ;
LINKLIBS on $(LUASERVER) += -lm -lluabind -ldl -lstdc++ ;
# -Wl,-R,$(HOME)/software/$(HOST)/lib ;

if $(HAVE_LUA) {
 SEARCH_SOURCE += [ FDirName $(SUBDIR) lua ] ;
 SubDirC++Flags -DHAVE_LUA ;
 UsingLua ;
 UsingLuabind ;

 Main $(LUASERVER) : $(LUASERVER_SOURCES) ;
}

Main $(SERVER) : $(SERVER_SOURCES) ;
